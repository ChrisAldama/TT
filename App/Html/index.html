<!DOCTYPE html>
<html lang="en">
<head>

  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  <title>Olinki</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link href="http://fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

  <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/skeleton.css">
  <link href="node_modules/dragula/dist/dragula.css" rel="stylesheet" type="text/css">
  <link href="css/index.css" rel="stylesheet" type="text/css">

  <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="icon" type="image/png" href="images/favicon.png">

</head>
<body>

  <!-- Primary Page Layout
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <div class="container">
    <div class="row">
      <div class="one-third column">
        <h4>Bloques</h4>
        <p>Arrastra los bloques hacia la derecha para construir el programa</p>
        <!-- Bloques de Programa -->
        <div id="blocks" class="blocks">
          <h5 class="label" onclick="hideShowClass('c-fun');">
            <a href="#">Funciones</a>
          </h5>
          <!-- Mensajes -->
          <div id = "exp-mess" class="p-bloque p-expr c-fun" tipo="mess">
            <div id ="exp-igual-cont-m"  class="p-expr-in">
              Mensaje
             <a class="operator"> =</a>
              <input type="text" class="p-repetir-input">
            </div>
            </div>
            <!-- ESPERA -->
            <div id = "exp-sl" class="p-bloque p-expr c-fun" tipo="delay">
            <div id ="exp-igual-cont-sl"  class="p-expr-in">
              Espera
             <a class="operator"> =</a>
              <input type="text" class="p-repetir-input">
            </div>
            </div>
            <!-- LED -->
           <div id = "led" class="p-bloque p-expr c-fun" tipo="led">
           <div id ="exp-igual-cont-l"  class="p-expr-in">
             <select class="">
                 <option class="operation">led1</option>
                <option class="operation">led2</option>
            </select>
            <a class="operator"> =</a>
             <input type="text" class="p-repetir-input">
           </div>
           </div>
            <!-- LED e-->
           <div id = "lede" class="p-bloque p-expr c-fun" tipo="lede">
           <div id ="exp-igual-cont-le"  class="p-expr-in">
             <select class="">
                 <option class="operation">led1</option>
                <option class="operation">led2</option>
            </select>
            <a class="operator"> =</a>
              <select class="">
                <option class="operation">Encendido</option>
                <option class="operation">Apagado</option>
            </select>
           </div>
           </div>
           <!-- Motor -->
           <div id = "exp-igual-m" class="p-bloque p-expr c-fun" tipo="motor">
           <div id ="exp-igual-cont-m"  class="p-expr-in">
             <select class="">
                <option class="operation">motor1</option>
                <option class="operation">motor2</option>
            </select>
            <a class="operator"> =</a>
            <select class="">
                <option class="operation">Alto</option>
                <option class="operation">Derecha</option>
                <option class="operation">Izquiera</option>
            </select>
           </div>
           </div>
         
           <!-- Boton -->
           <div id = "exp-igual-bo" class="p-bloque p-expr c-fun" tipo="boton">
           <div id ="exp-igual-cont-bo"  class="p-expr-in">
             <input type="text" class="p-repetir-input">
            <a class="operator"> =</a>
             <select class="">
                <option class="operation">Boton0</option>
                <option class="operation">Boton1</option>
            </select>
           </div>
           </div>
           
             <!-- Temp -->
           <div id = "exp-igual-t" class="p-bloque p-expr c-fun" tipo="temp">
           <div id ="exp-igual-cont-t"  class="p-expr-in">
             <input type="text" class="p-repetir-input">
            <a class="operator"> =</a>
             Temperatura
           </div>
           </div>
           
           <!-- Analogo -->
           <div id = "exp-igual-a" class="p-bloque p-expr c-fun" tipo="analog">
           <div id ="exp-igual-cont-a"  class="p-expr-in">
             <input type="text" class="p-repetir-input">
            <a class="operator"> =</a>
             Analogo
           </div>
           </div>
           
           
         <h5 class="label" onclick="hideShowClass('c-expr');">
           <a href="#">
             Expresiones
           </a>
           </h5>
         <!-- Bloque Asignacion -->

         <div id = "exp-igual" class="p-bloque p-expr c-expr" tipo="asig">
           <div id ="exp-igual-cont"  class="p-expr-in">
             <input type="text" class="p-repetir-input">
            <a class="operator"> =</a>
             <input type="text" class="p-repetir-input">
           </div>
           </div>
           <!-- Bloque de Operacion -->
           <div id = "exp-op" class="p-bloque p-expr c-expr" tipo="expr-op">
            <div id = "exp-op-cont" class="p-expr-in">
               <input type="text" class="p-min-input">
              <a class="operator"> =</a>
              <input type="text" class="p-min-input">
              <select class="p-min-min-input">
                 <option class="operation">+</option>
                <option class="operation">-</option>
                <option class="operation">x</option>
                <option class="operation">/</option>
                <option class="operation">%</operation>
                </select>
                <input type="text" class="p-min-input">
            </div>
           </div>

          <h5 class="label" onclick="hideShowClass('c-con');">
            <a href="#">Condicionales</a>
          </h5>
          <!-- Bloque Repetir -->
         <div id = "exp-otravez" class="p-bloque p-repetir c-con" tipo="loop">
             <div id = "exp-otravez-arriba" class="p-repetir-sup">
               <div id = "exp-otravez-estilo" style="margin-left:5px;">
               Repetir: <input type="number" min="0" class="p-repetir-input">
               </div>
            </div>
            <div id = "exp-otravez-medio" class="p-repetir-mid"><br><br></div>
            <div id = "exp-otravez-abajo" class="p-repetir-inf"></div>
          </div>
          <!-- Bloque Mientras -->
          <div id = "exp-otravez" class="p-bloque p-repetir c-con" tipo="while">
              <div id = "exp-otravez-arriba" class="p-repetir-sup">
                <div id = "exp-otravez-estilo"  class="row">
                <div class="one column" style="margin-left:5px;">
                  M:
                </div>
                <div  classs="column" style="margin-left:40px;" >
                <div id = "exp-logic" class="p-expr-log" tipo="expr-log">
                <div id = "exp-logic-cont" class="p-expr-in">
                  <input type="text" class="p-min-input">
                  <select class="p-min-input">
                    <option class="operation">&gt;</option>
                    <option class="operation">&gt;=</option>
                    <option class="operation">&lt;</option>
                    <option class="operation">&lt;=</option>
                     <option class="operation">==</option>
                     <option class="operation">!=</option>
                    </select>
                    <input type="text" class="p-min-input">
                </div>
                </div>
              </div>
                </div>

             </div>
             <div id = "exp-otravez-medio" class="p-repetir-mid"><br><br></div>
             <div id = "exp-otravez-abajo" class="p-repetir-inf"></div>
           </div>
          <!-- Bloque Si -->
          <div class="p-bloque p-si c-con" tipo="if">
             <div id = "exp-si-arriba" class="p-si-sup row">
               <div style="margin-left:5px;" class="p-log-lab one column">
               Si
               </div>
               <div id = "exp-si-caja" class="p-log  column p-logica">
                 <div id = "exp-logic" class="p-expr-log" tipo="expr-log">
                 <div id = "exp-logic-cont" class="p-expr-in">
                   <input type="text" class="p-min-input">
                   <select class="p-min-input">
                     <option class="operation">&gt;</option>
                     <option class="operation">&gt;=</option>
                     <option class="operation">&lt;</option>
                     <option class="operation">&lt;=</option>
                      <option class="operation">==</option>
                      <option class="operation">!=</option>
                     </select>
                     <input type="text" class="p-min-input">
                 </div>
                 </div>
                </div>
            </div>
            <div id = "exp-si-medio" class="p-si-mid"><br><br></div>
            <div id = "exp-si-abajo" class="p-si-inf"></div>
          </div>
          <!-- Bloque SiNo -->
           <div class="p-bloque p-sino c-con" tipo="ifelse">
             <div id = "exp-sino-si-arriba" class="p-sino-sup row">
               <div style="margin-left:5px;" class="p-log-lab one column">
               Si
               </div>
               <div class="p-log  column">
                 <div id = "exp-logic" class="p-expr-log" tipo="expr-log">
                 <div id = "exp-logic-cont" class="p-expr-in">
                   <input type="text" class="p-min-input">
                   <select class="p-min-input">
                     <option class="operation">&gt;</option>
                     <option class="operation">&gt;=</option>
                     <option class="operation">&lt;</option>
                     <option class="operation">&lt;=</option>
                      <option class="operation">==</option>
                      <option class="operation">!=</option>
                     </select>
                     <input type="text" class="p-min-input">
                 </div>
                 </div>
                </div>
            </div>
            <div id = "exp-sino-arriba-med1" class="p-sino-mid p-sino-mid-1"><br><br></div>
            <div id = "exp-sino-medio" class="p-sino-sup-mid row">
               <div style="margin-left:5px;" class="p-log-lab one column">
               SiNo
               </div>
            </div>
            <div id = "exp-sino-arriba-med2" class="p-sino-mid p-sino-mid-2"><br><br></div>
            <div id = "exp-sino-abajo" class="p-sino-inf"></div>
          </div>
        </div>
        <h5 class="label" onclick="hideShowClass('c-cons');">
          <a href="#">Consola</a>
        </h5>
        <div class="label c-cons">
          <div id="consola"></div>
        </div>

        </div>
      <div class="two-thirds column" id="programa-view">
        <ul class="m_menu">
          <li class="m_menu_item"><h4>Programa</h4></li>
          <li class="m_menu_item">
            <a onclick="arranca();" class="button">
            Arranca
            </a>
          </li>
          <li class="m_menu_item">
            <a onclick="detiene();" class="button">
              Detiene
            </a>
          </li>
       </ul>
        <!-- Prgrama -->
        <div id="program" class="program">
          <!-- Bloque de Inicio -->
          <div class="p-bloque p-inicio" tipo="begin">
            <a class="l-inicio">Inicio</a>
          </div>
          <!-- Bloque Fin -->
          <div class="p-bloque p-fin" tipo="end">
            <a class="l-inicio">Fin</a>
          </div>
        </div>
        <!-- Fin de Programa -->
      </div>
    </div>
  </div>


<!-- End Document
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <!-- Scripts -->
  <script src="node_modules/dragula/dist/dragula.js"></script>
  <script src="js/index.js"></script>
  <script src="js/qwebchannel.js"></script>
  <script src="js/parser.js"></script>
  <script src="js/qt.js"></script>
    <!-- Conversion Json -->
<script type="text/javascript">

function arranca(){
    var r = parse(document.getElementById("program").children);
    console.log(JSON.stringify(r));
    WebChannel.sendProgram(JSON.stringify(r), function(e){
      console.log("running: " + e);
    });
}

function detiene(){
  WebChannel.stopProgram();
}

function getIndexCSS(className){
  var css = document.styleSheets[4];
  var rules = css.cssRules || ss.rules;
  var rule = null;
  var reg = new RegExp("(^|,) *\."+className+" *(,|$)");
  for(var i = 0; i < rules.length; ++i){
    var r = rules[i];
    if(reg.test(r.selectorText)){
      rule = r;
      break;
    }
  }
  return rule;
}

function hideShowClass(className){
  var rule = getIndexCSS(className);
  var display = rule.style.display;
  if(display == "none"){
    rule.style.display = "block";
  }
  else {
    rule.style.display = "none";
  }


}

</script>
</body>
</html>
